<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>Office on ä¿¡æ¯ä¸­æ¢</title><link>https://ezkemj.github.io/myHugo/tags/office/</link><description>Recent content in Office on ä¿¡æ¯ä¸­æ¢</description><generator>Hugo -- 0.150.0</generator><language>zh-cn</language><lastBuildDate>Thu, 25 Sep 2025 16:10:00 +0800</lastBuildDate><atom:link href="https://ezkemj.github.io/myHugo/tags/office/index.xml" rel="self" type="application/rss+xml"/><item><title>æ‰¹å¤„ç†è„šæœ¬ç¤ºä¾‹ï¼šæ£€æµ‹ Office å®‰è£…è·¯å¾„å¹¶è°ƒç”¨ ospp.vbs</title><link>https://ezkemj.github.io/myHugo/zh-cn/posts/detecttheinstallationpathofmicrosoftoffice/</link><pubDate>Thu, 25 Sep 2025 16:10:00 +0800</pubDate><guid>https://ezkemj.github.io/myHugo/zh-cn/posts/detecttheinstallationpathofmicrosoftoffice/</guid><description>&lt;h2 id="-ç®€ä»‹"&gt;ğŸ“Œ ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡å±•ç¤ºä¸€ä¸ª &lt;strong&gt;æ‰¹å¤„ç†è„šæœ¬ç¤ºä¾‹&lt;/strong&gt;ï¼Œç”¨äºæ£€æµ‹ Microsoft Office çš„å®‰è£…è·¯å¾„ï¼Œå¹¶è°ƒç”¨è‡ªå¸¦çš„ &lt;code&gt;ospp.vbs&lt;/code&gt; è„šæœ¬æ‰§è¡Œæ“ä½œã€‚&lt;br&gt;
è¯¥ç¤ºä¾‹ä»…ç”¨äºå­¦ä¹  &lt;strong&gt;æ‰¹å¤„ç†é€»è¾‘&lt;/strong&gt;ï¼ˆå¾ªç¯ã€æ¡ä»¶åˆ¤æ–­ã€è·¯å¾„æ£€æµ‹ï¼‰ï¼Œä¸åŒ…å«ä»»ä½•æ¿€æ´»æˆ–ç ´è§£å†…å®¹ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;å…è´£å£°æ˜&lt;/strong&gt;ï¼šæœ¬æ–‡ä»…ä¾›å­¦ä¹  Windows æ‰¹å¤„ç†è„šæœ¬ç¼–å†™æ–¹æ³•ã€‚è¯·å‹¿å°†æ­¤ç±»è„šæœ¬ç”¨äºè§„é¿å•†ä¸šè½¯ä»¶æˆæƒæˆ–å…¶ä»–è¿æ³•ç”¨é€”ï¼Œå¦åˆ™åæœè‡ªè´Ÿã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id="-åŠŸèƒ½è¯´æ˜"&gt;ğŸ›  åŠŸèƒ½è¯´æ˜&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;éå†å¸¸è§çš„ Office å®‰è£…ç›®å½•ï¼ˆx64 ä¸ x86ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ£€æµ‹ä¸åŒç‰ˆæœ¬çš„ Officeï¼ˆ2010/2013/2016+ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæ‰¾åˆ° &lt;code&gt;ospp.vbs&lt;/code&gt;ï¼Œåˆ™åˆ‡æ¢åˆ°å¯¹åº”ç›®å½•å¹¶æ‰§è¡Œç¤ºä¾‹å‘½ä»¤ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 id="-è„šæœ¬ä»£ç "&gt;ğŸ’» è„šæœ¬ä»£ç &lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bat" data-lang="bat"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;@&lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; off
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;title&lt;/span&gt; Office Script Example
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; Detecting Office version...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;:&lt;span style="color:#75715e"&gt;: å®šä¹‰å¯èƒ½çš„ Office ç‰ˆæœ¬å·&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;office_paths=16 15 14&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;found=0&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;:&lt;span style="color:#75715e"&gt;: éå† x64 å’Œ x86 å®‰è£…ç›®å½•&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;%%&lt;/span&gt;p &lt;span style="color:#66d9ef"&gt;in&lt;/span&gt; (&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;%ProgramFiles%&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;%ProgramFiles(x86)%&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;) &lt;span style="color:#66d9ef"&gt;do&lt;/span&gt; (
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;%%&lt;/span&gt;v &lt;span style="color:#66d9ef"&gt;in&lt;/span&gt; (%office_paths%) &lt;span style="color:#66d9ef"&gt;do&lt;/span&gt; (
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;exist&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;%%&lt;/span&gt;&lt;span style="color:#e6db74"&gt;~p\Microsoft Office\Office&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;%%&lt;/span&gt;&lt;span style="color:#e6db74"&gt;v\ospp.vbs&amp;#34;&lt;/span&gt; (
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;set&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;office_path=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;%%&lt;/span&gt;&lt;span style="color:#e6db74"&gt;~p\Microsoft Office\Office&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;%%&lt;/span&gt;&lt;span style="color:#e6db74"&gt;v&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;set&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;office_version=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;%%&lt;/span&gt;&lt;span style="color:#e6db74"&gt;v&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;set&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;found=1&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;goto&lt;/span&gt; :version_found
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;:version_found
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;%found%&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#f92672"&gt;==&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;0&amp;#34;&lt;/span&gt; (
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; Office installation not found.
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;goto&lt;/span&gt; :end
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;cd&lt;/span&gt; /d &lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;%office_path%&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;:&lt;span style="color:#75715e"&gt;: ç¤ºä¾‹ï¼šè°ƒç”¨ ospp.vbsï¼ˆæ­¤å¤„ä»…æ¼”ç¤ºï¼Œä¸åŒ…å«æ¿€æ´»å‘½ä»¤ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cscript ospp.vbs /dstatus
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; Process completed
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;timeout /t 5
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;:end
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item></channel></rss>